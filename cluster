library(ChemmineR)
library(ChemmineOB)

#loading sdf file (containg many sdf molecules)
sdfset <- read.SDFset("web address to sdf file/local sdf file")

#Checking for duplicates
unique_ids <- makeUnique(sdfid(sdfset))

 #list of molecules' IDs
 cid(sdfset)
 
 #Creating data frame with all of the IDs
 AllIds <- data.frame(ID=cid(sdfset))
 
 #Creating fingerprints for every molecule (FP2)
fpset <- fingerprintOB(sdfset,"FP2")

# Clustering, results printed to the screen
counter <- nrow(AllIds)
z <- c(1:counter)

k <- 1

clustering <- function () {
   while(counter > 0 ) {
      a <- rownames(as.matrix(fpSim(fpset[as.character(AllIds[1,])], fpset, method="Tanimoto", cutoff=0.3)))
      cluster <<- data.frame(ID=a)
      del <- (!c(AllIds$ID %in% cluster$ID))
      AllIds <- AllIds[del,]
      AllIds <- data.frame(ID= AllIds)
      counter <<- nrow(AllIds)
      cat((i), z[k])
      cat("\n")
      print(cluster)
      cat("\n")
      k <- k+1
   }
 }
 
 # This method will cluster every molecule but often one molecule will be found in several clusters. 











